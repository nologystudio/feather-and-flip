"use strict";var formSubmit=window.location.protocol+"//"+window.location.host+"/api/forms",ppControllers=angular.module("ppControllers",[]),drupalTemplatePath="/sites/all/themes/passported/";ppControllers.controller("AppController",function(e,a,n,t){e.user,e.view,e.loading=!1,e.error=!1,e.resetPassword=!1,e.isMobile=Modernizr.touch&&$(window).width()<800?!0:!1;var o=function(e){},i=function(){$("#newsletter-block").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInDown")},200)},{offset:"0%"}),$("body > header").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInDown")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeInDown")},400),n(function(){e.find('*[data-animate="3"]').addClass("animated fadeInDown")},600),n(function(){e.find('*[data-animate="4"]').addClass("animated fadeInDown")},800),n(function(){e.find('*[data-animate="5"]').addClass("animated fadeInDown")},1e3),n(function(){e.find('*[data-animate="6"]').addClass("animated fadeInDown")},1200),n(function(){e.find('*[data-animate="7"]').addClass("animated fadeInDown")},1400),n(function(){e.find('*[data-animate="8"]').addClass("animated fadeIn")},1600),n(function(){e.find('*[data-animate="9"]').addClass("animated fadeIn")},1800)},{offset:"10%"}),$("#passported-intro").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInUp")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeInUp")},400),n(function(){e.find('*[data-animate="3"]').addClass("animated fadeInUp")},600),n(function(){e.find('*[data-animate="4"]').addClass("animated fadeInUp")},800),n(function(){e.find('*[data-animate="5"]').addClass("animated fadeInUp")},1e3),n(function(){e.find('*[data-animate="6"]').addClass("animated fadeInUp")},1200),n(function(){e.find('*[data-animate="7"]').addClass("animated fadeInUp")},1400)},{offset:"10%"}),$("#inspiration").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeIn")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeIn")},600)},{offset:"100%"}),$("#inspiration").waypoint(function(){},{offset:"90px"}),$("#how-it-works").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInUp")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeIn")},400),n(function(){e.find('*[data-animate="3"]').addClass("animated fadeIn")},600),n(function(){e.find('*[data-animate="4"]').addClass("animated fadeIn")},800),n(function(){e.find('*[data-animate="5"]').addClass("animated fadeIn")},1e3),n(function(){e.find('*[data-animate="6"]').addClass("animated fadeIn")},1200),n(function(){e.find('*[data-animate="7"]').addClass("animated fadeIn")},1400),n(function(){e.find('*[data-animate="8"]').addClass("animated fadeIn")},1600),n(function(){e.find('*[data-animate="9"]').addClass("animated fadeIn")},1800),n(function(){e.find('*[data-animate="10"]').addClass("animated fadeIn")},2e3)},{offset:"50%"}),$("#newsletter").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInUp")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeInUp")},600)},{offset:"75%"}),$("#map").waypoint(function(){var e=$(this);o("map"),n(function(){e.find('*[data-animate="1"]').addClass("animated fadeIn")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeInLeft")},400),n(function(){e.find('*[data-animate="3"]').addClass("animated fadeInRight")},600)},{offset:"30%"}),$("#travel-journal").waypoint(function(){var e=$(this);o("travel-journal"),n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInUp")},200),e.hasClass("related")||n(function(){e.find('*[data-animate="2"]').addClass("animated fadeIn")},400)},{offset:"75%"}),$("#press").waypoint(function(){var e=$(this);o("press"),n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInDown")},200),n(function(){e.find('*[data-animate="2"]').addClass("animated fadeInDown")},400),n(function(){e.find('*[data-animate="3"]').addClass("animated fadeInDown")},600),n(function(){e.find('*[data-animate="4"]').addClass("animated fadeInDown")},800),n(function(){e.find('*[data-animate="5"]').addClass("animated fadeInDown")},1e3),n(function(){e.find('*[data-animate="6"]').addClass("animated fadeInDown")},1200),n(function(){e.find('*[data-animate="7"]').addClass("animated fadeInDown")},1400),n(function(){e.find('*[data-animate="8"]').addClass("animated fadeInDown")},1600)},{offset:"75%"}),$("body > footer").waypoint(function(){var e=$(this);n(function(){e.find('*[data-animate="1"]').addClass("animated fadeInDown")},200)},{offset:"75%"})},s=function(){var a=$("div.dropdown-wrapper"),t=a.find("div.arrow"),o=$("#city-guides-list"),i=$("#search-block"),s=300,r=$(window).height()-90,d=!1,l=function(){n(function(){a.find('*[data-animate="1"]').addClass("animated fadeInUp")},200),n(function(){a.find('*[data-animate="2"]').addClass("animated fadeInUp")},400),n(function(){a.find('*[data-animate="3"]').addClass("animated fadeInUp")},600),n(function(){a.find('*[data-animate="4"]').addClass("animated fadeInUp")},800)},c=function(){};e.isMobile?$("button.mobile-nav-trigger").on("click",function(){$("header > nav").toggleClass("mobile")}):($("div.dropdown-wrapper").on({mouseover:function(){d=!0}}),$("header > nav a.subnav").on({mouseover:function(){var e=$(this).offset().left+10+$(this).width()/2,n;switch(d=!0,$(this).attr("id")){case"city-guides":a.removeClass("light"),n="city-guides";break;case"search":a.addClass("light"),n="search"}setTimeout(function(){d&&(t.css({left:e+"px"}).addClass("on"),"city-guides"==n&&(a.show().transition({height:r+"px"},function(){$(this).css({overflow:"visible"})}),o.show().transition({opacity:1}),i.hide()),"search"==n&&(a.show().transition({height:"220px"},function(){$(this).css({overflow:"visible"})}),i.show().transition({opacity:1}),o.hide()))},s)}}),$("header > nav a.subnav, div.dropdown-wrapper").on({mouseout:function(){d=!1,setTimeout(function(){d||(a.css({overflow:"hidden"}),t.removeClass("on"),a.transition({height:0},function(){a.hide()}),o.transition({opacity:0},function(){o.hide()}),i.transition({opacity:0},function(){i.hide()}))},s)}}))},r=function(){$("body").transit({opacity:1},function(){e.isMobile||i(),s()}),$("body").imagesLoaded().always(function(e){})};e.state=t.path().replace("/",""),e.goToURL=function(e){window.location=e},n(function(){r()},200)}),ppControllers.controller("MapController",function(e,a,n,t){e.map,e.lat=30,e.lon=-30,e.inspirationSearch;var o=new google.maps.LatLngBounds,i=[],s=[],r="passported",d=function(){$("#map").css({height:$(window).height()-90+"px"})},l=function(){var a={zoom:3,center:new google.maps.LatLng(e.lat,e.lon),zoomControl:!0,mapTypeControl:!1,draggable:!0,scrollwheel:!1,scaleControl:!0,streetViewControl:!0,overviewMapControl:!1,panControl:!1,panControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,r]},mapTypeId:r},n=[{stylers:[{hue:"#D8DCDB"},{visibility:"simplified"},{gamma:0},{weight:.5}]},{elementType:"labels",stylers:[{visibility:"on"},{color:"#AAAAAA"}]},{featureType:"water",stylers:[{color:"#BBCAD0"}]},{featureType:"road",stylers:[{color:"#D8DCDB"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#D8DCDB"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#F0F2F1"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#F0F2F1"}]}],t={name:"Passported"};e.map=new google.maps.Map(document.getElementById("google-maps-container"),a),e.map.mapTypes.set(r,new google.maps.StyledMapType(n,t))};e.addMarkers=function(n,t){var r="/sites/all/themes/passported/media/icons/";switch(n){case"destinations":_.map(t,function(n){var t=new google.maps.Marker({position:{lat:Number(n.lat),lng:Number(n.lon)},map:e.map,title:n.name,icon:r+"map-pin-icon.svg"});t.addListener("click",function(){e.map.setZoom(15),e.map.setCenter(t.getPosition()),a.$emit("display-destination",[n])}),s.push(t),o.extend(t.position)}),e.map.fitBounds(o);break;case"guide":var d=0==t.zoom_level.length?12:Number(t.zoom_level),l=0==t.addressbook_reference.length?[t.lat,t.lon]:[t.addressbook_reference.lat,t.addressbook_reference.lon],c=[t.guide,t.hotels];_.map(s,function(e){e.setMap(null),e=null}),_.map(c,function(a){_.map(a,function(a){if(a.isLoaded||void 0===a.isLoaded){var n=_.isUndefined(a.assoc_interests)?"stay":a.assoc_interests.toLowerCase(),t=_.isUndefined(a.title)?a.name:a.title,s=_.isUndefined(a.short_description)?a.short_review:a.short_description,d=new google.maps.Marker({position:{lat:Number(a.lat),lng:Number(a.lon)},type:n,id:a.id,map:e.map,title:t,icon:r+n+"-pin-icon.svg"}),l=new google.maps.InfoWindow({content:'<div class="in-map '+n+'"><h1>'+t+"</h1><h2>"+s+"</h2></div>",maxWidth:200});d.addListener("click",function(){e.map.setZoom(16),e.map.setCenter(d.getPosition()),l.open(e.map,d)}),o.extend(d.position),i.push(d)}})}),e.map.fitBounds(o),e.map.setCenter(new google.maps.LatLng(Number(l[0]),Number(l[1]))),e.map.setZoom(d);break;case"pick":var u=t,p=_.isUndefined(u.assoc_interests)?"stay":u.assoc_interests.toLowerCase(),f=_.isUndefined(u.title)?u.name:u.title,m=_.isUndefined(u.short_description)?u.short_review:u.short_description,g=new google.maps.Marker({position:{lat:Number(u.lat),lng:Number(u.lon)},type:p,id:u.id,map:e.map,title:f,icon:r+p+"-pin-icon.svg"}),h=new google.maps.InfoWindow({content:'<div class="in-map '+p+'"><h1>'+f+"</h1><h2>"+m+"</h2></div>",maxWidth:200});g.addListener("click",function(){e.map.setZoom(16),e.map.setCenter(g.getPosition()),h.open(e.map,g)}),o.extend(g.position),i.push(g)}};var c=function(a){_.map(i,function(n){n.type==a||_.isUndefined(a)?n.setMap(e.map):n.setMap(null)})};t(function(){d(),l()},0),$(window).on("resize",function(){d()}),a.$on("filter-map",function(e,a){c(a[0])}),a.$on("display-pick",function(e,a){_.map(i,function(e){e.id==a[0]&&google.maps.event.trigger(e,"click")})})}),ppControllers.controller("ItineraryController",function(e,a,n,t,o,i,s){var r=window.location.protocol+"//"+window.location.host+"/api/content/",d=t(r+"destinations.json"),l=t(r+"address-books.json"),c=t(r+"hotels.json"),u=t("https://go.passported.com/api/v2/location");if(e.itineraryIsReady,e.cityGuideID,e.step=_.isUndefined(e.cityGuideID)?1:2,e.pick,e.showAside=!0,e.filter=void 0,e.dayOfWeek=moment().day()-1,e.hotelFilters=[],e.addressFilters={eat:[],"do":[],noteworthy:[],shop:[]},e.check={phone:function(e){return _.isArray(e)},features:function(e){return _.isArray(e)}},e.setClass=function(e){var a="";return _.map(e,function(e){_.each(e,function(n,t){var o=t==e.length-1?"":" ";a+=n.toLowerCase()+o})}),a},e.openLeftAside=function(){e.showAside=!e.showAside,$("#map").toggleClass("full"),google.maps.event.trigger(e.map,"resize")},e.openHours=function(e){var a=$("#a-"+e),n=Boolean(a.data("state")),t=a.find("li").toArray();a.data("state",!n),_.map(t,function(e){$(e).hasClass("selected")||(n?$(e).show():$(e).hide())})},e.goTo=function(a){e.step=a},e.displayDestination=function(a){e.pick=a,l.query({destination:a.id},function(n){e.pick.guide=n,_.extend(e.pick,{guide_by_category:angular.copy(e.addressFilters)}),_.map(n,function(a){if(_.isUndefined(e.pick.guide_by_category[a.assoc_interests.toLowerCase()])||e.pick.guide_by_category[a.assoc_interests.toLowerCase()].push(a),!_.isArray(a.google_place_id)){var n=new google.maps.places.PlacesService(e.map),t=function(){n.getDetails({placeId:a.google_place_id},function(n,o){o==google.maps.places.PlacesServiceStatus.OK&&(a.title=n.name,a.lat=n.geometry.location.lat(),a.lon=n.geometry.location.lng(),a.phone_number=n.international_phone_number,a.address=n.formatted_address,a.website=n.website,a.hours=_.isUndefined(n.opening_hours)?void 0:n.opening_hours.weekday_text,a.open=_.isUndefined(n.opening_hours)?void 0:n.opening_hours.open_now,a.isLoaded===!1&&(e.$parent.addMarkers("pick",a),a.isLoaded=!0)),o==google.maps.places.PlacesServiceStatus.OVER_QUERY_LIMIT&&(a.isLoaded=!1,setTimeout(function(){t()},3e3))})};t()}_.map(a.guide_categories,function(a,n){var t=n.toLowerCase();_.map(a,function(a){-1==_.indexOf(e.addressFilters[t],a.toLowerCase())&&e.addressFilters[t].push(a.toLowerCase())})})}),c.query({destination:a.id},function(n){e.pick.hotels=n,e.$parent.addMarkers("guide",a),_.map(e.pick.hotels,function(a){_.map(a.guide_categories,function(a){_.map(a,function(a){-1==_.indexOf(e.hotelFilters,a.toLowerCase())&&e.hotelFilters.push(a.toLowerCase())})})});var t=_.filter(e.pick.hotels,function(e){return"1"==e.featured});e.pick.hotels=_.filter(e.pick.hotels,function(e){return"0"==e.featured}),_.extend(e.pick.hotels,t)})}),e.step=2,$("#step-2").delay(500).transition({opacity:1},"fast",function(){e.itineraryIsReady=!0,e.$apply()})},_.isUndefined(e.cityGuideID)&&_.isUndefined(e.inspirationSearch))e.destinations=d.query({},function(a){e.$parent.addMarkers("destinations",a)});else if(_.isUndefined(e.cityGuideID)){if(!_.isUndefined(e.inspirationSearch)){var p=o.search();e.destinations=d.query({place_type:p.place,season:p.season},function(a){e.$parent.addMarkers("destinations",a)})}}else e.pick=d.query({id:e.cityGuideID},function(a){e.displayDestination(a[0])});e.filterMap=function(a){e.filter=a,_.isUndefined($("#guide-wrapper."+a))||$("#step-2 div.wrapper").animate({scrollTop:780},1e3),s.$emit("filter-map",[a])},s.$on("display-destination",function(a,n){e.displayDestination(n[0])}),e.highlightMarker=function(e){s.$emit("display-pick",[e])},e.book=function(e){s.$emit("open-booking",[e])}}),ppControllers.controller("BookingController",function(e,a,n,t,o){var i={formID:"bookHotel",destination:"",hotel:"",name:void 0,last:void 0,email:void 0,start_date:void 0,end_date:void 0,adults:0,children:0,budget:void 0,specific_budget:void 0,message:void 0};e.error,e.showRightAside=!1,e.showCalendar=!1,e.booking=angular.copy(i),e.openAside=function(){e.showRightAside=!e.showRightAside,$("#map").toggleClass("full"),google.maps.event.trigger(e.map,"resize"),e.showRightAside||(e.booking=angular.copy(i))},e.setter={checkButtons:function(){$("*.budget-check").on("click",function(){return $("*.budget-check span").removeClass("on"),$(this).find("span").toggleClass("on"),!1})},calendarButtons:function(){$("*.icon-calendar").on("click",function(){return e.showCalendar=!0,e.$apply(),!1})},date:function(){},budget:function(a){e.booking.budget=a}},e.submit=function(){$("aside.right #step-1 ul li").transition({opacity:0},function(){$(this).hide()}),t({method:"POST",url:formSubmit,data:$.param(e.booking),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(e){$("#booking-message").show().transition({opacity:1})}).error(function(){})},o.$on("open-booking",function(a,n){e.showRightAside=!0,e.booking.destination=n[0].destination,e.booking.hotel=n[0].name}),e.$watch("booking",function(a,n){_.isEqual(a,n)||_.map(a,function(t,o){if(a[o]!=n[o])switch(o){case"start_date":case"end_date":_.isUndefined(e.booking.start_date)||_.isUndefined(e.booking.end_date)||(moment(e.booking.end_date).isBefore(e.booking.start_date)?e.error="Please make sure you have selected correct dates":e.error=!1);break;case"adults":_.isUndefined(e.booking.adults)||0==e.booking.adults?e.error="Please make sure you have selected correct adults":e.error=!1}})},!0),n(function(){e.setter.checkButtons(),e.setter.calendarButtons()},0)}),ppControllers.controller("CalendarController",function(e,a,n){var t=$("#arrival-gallery"),o=$("#departure-gallery");e.year=[],e.getMonth=function(e,a){var n=a,t=new Date(n,e,1),o=new Date(n,e,moment(n+"-"+(e+1),"YYYY-MM").daysInMonth()),i=moment().range(t,o),s={start:0==t.getDay()?6:t.getDay()-1,days:{}};return i.by("days",function(e){s.days[moment(e._d).format("D")]=moment(e._d).format("MM/DD/YYYY")}),s},e.buildYear=function(){var a=moment().get("year"),n=moment().get("month"),t=new Date(a,n,1),o=new Date(a+1,n,moment(a+1+"-"+n,"YYYY-MM").daysInMonth()),i=moment().range(t,o),s=[];i.by("months",function(a){var n=moment(a._d).get("month"),t=moment(a._d).get("year");e.year.push({name:moment(a._d).format("MMMM")+" "+t,order:e.getMonth(n,t)})})},n(function(){var a=function(a){a.sly({horizontal:1,itemNav:"forceCentered",smart:1,activateMiddle:1,mouseDragging:1,touchDragging:0,releaseSwing:1,startAt:0,scrollBy:1,speed:500,elasticBounds:1,prev:a.find('*[rel="prev"]'),next:a.find('*[rel="next"]')}),a.find("button").on("click",function(){switch($(this).hasClass("arrival")){case!0:e.booking.start_date=$(this).data("date"),$("#arrival button[data-date]").removeClass("on");break;case!1:e.booking.end_date=$(this).data("date"),$("#departure button[data-date]").removeClass("on")}return $(this).addClass("on"),e.$apply(),!1})};a(t),a(o)},0),e.buildYear()}),ppControllers.controller("BlogController",function(e,a,n){var t=$(".grid-wrapper"),o=$(".grid-wrapper *.quick-entry").toArray(),i=$(".grid-wrapper *.hidden").toArray(),s=$("#travel-journal").height();e.expand="view all",e.viewAll=function(){var a="view all"==e.expand?["view less","auto"]:["view all",s+"px"];switch(e.expand=a[0],$("#travel-journal").css({height:a[1]}),a[0]){case"view all":$("#travel-journal .hidden").transition({opacity:0},function(){$(this).hide()});break;case"view less":$("#travel-journal .hidden").show().transition({opacity:1})}},n(function(){$("#travel-journal").imagesLoaded().always(function(e){t.shuffle({itemSelector:".quick-entry"}),$(".grid-wrapper *.hidden").css({opacity:0})})},0)}),ppControllers.controller("PromotedController",function(e,a,n,t){}),ppControllers.controller("NewsletterController",function(e,a,n){var t="",o=["still","success","error"];e.currentStatus=o[0],e.signUpData={userEmail:""},e.checkChangedInput=function(a){var n=function(e,a){var n=$('*[name$="-'+e.split("user")[1].toLowerCase()+'"]'),t="warning";a?n.addClass(t):n.removeClass(t)};angular.forEach(e.data,function(e,a){n(a,angular.isUndefined(e))})},e.regSubmit=function(){""!=e.signUpData.userEmail&&$http({method:"POST",url:formSubmit,data:$.param({formID:"newsletterForm",userEmail:e.signUpData.userEmail}),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){e.currentStatus=o[1]}).error(function(){e.currentStatus=o[2]})}}),ppControllers.controller("SearchController",function(e,a,n,t){var o;e.userSearch="",e.destinations,e.hotels,e.showResult=!1,e.noResult=!1,e.reset=function(){e.userSearch="",e.$apply()},e.searchSubmit=function(){var a=function(){n({method:"POST",url:formSubmit,data:$.param({formID:"customSearch",key:e.userSearch}),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){a.destinations.length>0||a.hotels.length>0?(e.showResult=!0,e.destinations=a.destinations,e.hotels=a.hotels):e.userSearch.split("").length>0?(e.showResult=!0,e.noResult=!0):(e.showResult=!1,e.noResult=!1)}).error(function(){})};o&&clearTimeout(o),o=setTimeout(function(){a()},500)}}),ppControllers.controller("InspirationController",function(e,a,n,t,o){e.search={place:void 0,season:void 0},e.submitInspiration=function(){window.location=window.location.origin+"/inspiration/#/?place="+e.search.place+"&season="+e.search.season}}),ppControllers.controller("CallToActionController",function(e,a,n,t,o){var i=["hidden","signup","loading"],s=$(".call-to-action");e.overlayTpl=drupalTemplatePath+"library/templates/sign.tpl.html",e.isLoggedIn=e.user,e.isLoading=e.loading,e.triggerState=i[0],e.isSignPage=e.view,e.types=["sign-up","sign-in","response","reset-password","new-password","change-password","newsletter"],e.type=e.types[0],e.newsStatus="still",e.display=!1,e.resetPassword=e.resetPassword,e.changePassword=!1,e.triggerOverlay=function(){switch(e.triggerState){case"hidden":e.display=!1;break;default:e.display=!0,e.$digest()}},e.$watch("isLoggedIn",function(e){}),e.$watch("isSignPage",function(a){("sign-in"==a||"sign-up"==a)&&t(function(){e.type=a,e.triggerState=i[1],e.triggerOverlay(),$(".call-to-action").show().transition({opacity:1})},200)}),e.$watch("resetPassword",function(a){a&&t(function(){e.triggerState=i[1],e.triggerOverlay(),$(".call-to-action").show().transition({opacity:1})},200)}),e.$watch("changePassword",function(a){a&&(e.triggerState=i[1],e.triggerOverlay())}),e.$watch("isLoading",function(a){a&&(e.triggerState=i[3],e.triggerOverlay())}),a.$on("display-overlay",function(a,n){e.user||(e.triggerState=i[1],e.triggerOverlay(),$(".call-to-action").show().transition({opacity:1}))}),$("#change-password").on("click",function(a){e.changePassword=!0,e.$apply(),a.preventDefault()}),$("#sign-in").on("click",function(n){a.$emit("display-overlay",""),e.type=e.types[1],e.$apply(),n.preventDefault()}),$("#sign-up").on("click",function(n){a.$emit("display-overlay",""),e.type=e.types[0],e.$apply(),n.preventDefault()}),$("#newsletter-trigger").on("click",function(n){a.$emit("display-overlay",""),e.type=e.types[6],e.$apply(),n.preventDefault()}),$("#newsletter-block button.icon-close").on("click",function(e){$(this).parent().transition({top:"-100px"},function(){$(this).remove()}),$("body > header").transition({top:"0px"},function(){}),$('body > main[id="passported-intro"]').transition({top:"0px"},function(){}),o.put("nUser",!0),e.preventDefault()})}),ppControllers.controller("SignController",function(e,a,n,t){e.response=["success","error","error-in-login"],e.rMessage="",e.isValid=!0,e.signInError="",e.signUpError="",e.passwordError="",e.newsStatus="",e.loading=!1,e.data={userName:"",userLast:"",userEmail:"",userPassword:"",userRepassword:"",subscribeNewsletter:!0},e.switcher=function(a){e.type=a,e.data={userName:"",userLast:"",userEmail:"",userPassword:"",userRepassword:"",subscribeNewsletter:!0},e.signInError="",e.signUpError="",e.passwordError="",e.rMessage="",e.newsStatus=""},e.closeOverlay=function(){$(".call-to-action").transition({opacity:0},function(){$(this).hide()})},e.checkChangedInput=function(a){var n=function(a,n){var t=$('*[name$="-'+a.split("user")[1].toLowerCase()+'"]'),o="warning";n?(t.addClass(o),e.isValid=!1):t.removeClass(o)};return angular.forEach(e.data,function(e,a){n(a,angular.isUndefined(e))}),e.isValid},e.regSubmit=function(n){a({method:"POST",url:formSubmit,data:$.param(angular.extend({formID:"sign"+n},e.data)),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){if(a.result){var t=$(document)[0].referrer.split(".passported.com");t.length>1?window.location=$(document)[0].referrer:window.location.reload()}else e.loading=!1,"up"==n&&(e.signUpError="Your user already exists"),"in"==n&&(e.signInError="The user or password is incorrect")}).error(function(e){})},e.regNewsletter=function(){a({method:"POST",url:formSubmit,data:$.param({formID:"newsletterForm",userEmail:e.data.userEmail}),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){e.newsStatus="success",n(function(){e.closeOverlay(),$("#newsletter-block button.icon-close").trigger("click")},1e3)}).error(function(){e.newsStatus="error"})},e.changePassword=function(){var n=$('#password-form input[type="password"]');e.data.userRepassword==e.data.userPassword&&""!=e.data.userPassword?(n.removeClass("warning"),a({method:"POST",url:formSubmit,data:$.param({formID:"updatePassw",newPassw:e.data.userPassword}),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){switch(a.error){case"":e.closeOverlay();break;default:e.passwordError="Something went wrong, please try again later"}}).error(function(e){})):n.addClass("warning")},e.sendPasswordEmail=function(){a({method:"POST",url:formSubmit,data:$.param({formID:"resetPassw",userEmail:e.data.userEmail}),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){switch(a.error){case"":$("#password-form").transition({opacity:0},function(){e.rMessage="reset-password-success",e.$apply()});break;default:e.passwordError="The email does not exist"}}).error(function(e){})},e.$parent.changePassword&&e.switcher("change-password"),e.$parent.resetPassword&&e.switcher("new-password")}),ppControllers.controller("ContactController",function(e,a){e.data={userName:"",userLast:"",userEmail:"",userDepartment:"",userSubject:"",userMessage:""},e.success=!1,e.submitContact=function(){var n={formID:"contact",firstName:e.data.userName,lastName:e.data.userLast,email:e.data.userEmail,department:e.data.userDepartment,subject:e.data.userSubject,message:e.data.userMessage};a({method:"POST",url:formSubmit,data:$.param(n),headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:angular.identity}).success(function(a){$("#contact-form").transition({opacity:0},function(){e.success=!0,e.$apply()})}).error(function(){})}}),ppControllers.controller("SocialFeedController",function(e,a,n,t,o){e.instagram,e.loadInstagram=function(){var e="1058347608",a="1447456174.1677ed0.38a554ee737a4ff89b2c62517d45ba5d",n="https://api.instagram.com/v1/users/"+e+"/media/recent?access_token="+a+"&callback=JSON_CALLBACK";o.jsonp(n).success(function(e){console.log(e)})},e.loadInstagram()});